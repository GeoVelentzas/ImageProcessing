function [E,Z,M] = gdlog(I,s)

%********* ���������� ����������� ��� ��� ��������� ��� *******************
K = 31;                                           %������� �������
vk = (0:K-1)-(K-1)/2;                             %������ ��� gaussian
[u,v] = meshgrid(vk,vk);                          %���������� ��� ���������
G = 1 / (2*pi*s^2) * exp(-(u.^2+v.^2) / (2*s^2)); %���������� gaussian
Gu = -(u/s^2) .* G;                               %��������� ���� u
Gv = -(v/s^2) .* G;                               %��������� ���� v
%**************************************************************************


%****** ���������� ������� �� ��� 2D �������� ��� gaussian*****************
%********** ��� ����������� ��� ������ ��� ������������� ******************
Gx = imfilter(I, Gu, 'replicate', 'conv');        %����������� ���� x
Gy = imfilter(I, Gv, 'replicate', 'conv');        %����������� ���� y
M = sqrt(Gx.^2 + Gy.^2);                          %����������� ������
%**************************************************************************


%********* ����������� ������� �� ��� Laplacian of Gaussian ***************
%*************** ��� ����������� ��� zero crossings ***********************
L = fspecial('log', K, s);                       %���������� �������
Z = imfilter(I, L, 'replicate');                 %����������� �� LoG
Z1 = double(bwperim(Z>=0));                       %zero crossings
%**************************************************************************


%****** ����������� ����� ��� ��������������� ������� � ��� � *************
E = Z1.*M;                               %� ������� �dges
E = double(E>=(max(E(:))/10));           %uncomment
%**************************************************************************



end








